# SaltGoat 安全模块

## 📋 功能概述

安全模块提供全面的系统安全功能，包括安全扫描、SSL证书管理、防火墙配置等安全相关操作。

## 🚀 使用方法

### 基本语法
```bash
saltgoat <security_command> [options]
```

### 支持的安全功能

| 功能 | 命令 | 描述 |
|------|------|------|
| `security-scan` | 安全扫描 | 端口扫描、服务检查、权限验证 |
| `ssl` | SSL管理 | SSL证书生成、配置、管理 |

## 📖 使用示例

### 安全扫描
```bash
# 完整安全扫描
saltgoat security-scan

# 扫描结果包含:
# - 开放端口检查
# - 服务安全状态
# - 文件权限检查
# - 防火墙状态
# - 系统更新检查
# - 用户安全检查
# - 日志安全检查
```

### SSL证书管理
```bash
# 生成自签名证书
saltgoat ssl generate-self-signed example.com

# 配置Let's Encrypt证书
saltgoat ssl configure-letsencrypt example.com

# 查看证书状态
saltgoat ssl status

# 续期证书
saltgoat ssl renew
```

## 🔧 安全功能详解

### 安全扫描功能
- **端口扫描**: 检查开放端口，识别潜在风险
- **服务检查**: 验证服务配置安全性
- **权限检查**: 检查关键文件权限设置
- **防火墙检查**: 验证防火墙配置状态
- **更新检查**: 检查系统安全更新
- **用户检查**: 检查用户安全配置
- **日志检查**: 验证日志文件完整性

### SSL证书功能
- **自签名证书**: 快速生成测试用证书
- **Let's Encrypt**: 免费SSL证书申请和配置
- **证书管理**: 证书状态检查和续期
- **自动配置**: 自动配置Nginx SSL设置

## 📊 安全扫描结果

### 扫描报告示例
```
==========================================
SaltGoat 安全扫描
==========================================
[INFO] 扫描开放端口...
[SUCCESS] 未发现常见危险端口

[INFO] 检查服务安全状态...
[SUCCESS] Nginx: server_tokens 已关闭
[SUCCESS] MySQL: 绑定到本地地址

[INFO] 检查文件权限安全...
[WARNING] /etc/shadow: 权限过于宽松，建议设置为 640

[INFO] 检查防火墙状态...
[WARNING] UFW 防火墙: 未启用

[INFO] 检查系统更新...
[WARNING] 发现 6 个可用更新

[INFO] 检查用户安全...
[WARNING] SSH: Root 登录可能已启用
==========================================
```

### 安全评分
- **优秀**: 90-100分 - 安全配置完善
- **良好**: 80-89分 - 基本安全措施到位
- **一般**: 70-79分 - 需要加强安全配置
- **较差**: <70分 - 存在安全风险

## 🔒 安全建议

### 基础安全措施
1. **启用防火墙**: `sudo ufw enable`
2. **禁用Root登录**: 修改SSH配置
3. **定期更新**: 保持系统最新
4. **文件权限**: 设置正确的文件权限
5. **服务配置**: 关闭不必要的服务

### SSL安全配置
1. **使用HTTPS**: 为所有网站配置SSL
2. **证书续期**: 定期检查和续期证书
3. **安全协议**: 使用TLS 1.2+
4. **加密套件**: 配置安全的加密套件

## 📁 文件结构

```
modules/security/
├── security.sh            # 主安全扫描脚本
├── ssl.sh                 # SSL证书管理脚本
└── README.md              # 本文档
```

## 🔗 相关功能

- **故障诊断**: `saltgoat diagnose` - 系统故障诊断
- **性能分析**: `saltgoat profile analyze` - 性能分析
- **版本锁定**: `saltgoat version-lock` - 版本管理

## 📝 更新日志

- **v0.5.7** - 模块化重构，完善安全功能
- 全面的安全扫描功能
- SSL证书自动管理
- 安全评分和建议系统
