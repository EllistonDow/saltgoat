# Magento mysqldump Salt Schedule 示例
# 复制为 `salt/pillar/magento-schedule.sls` 并按站点填写

magento_schedule:
  mysql_dump_jobs:
    - name: site1-dump-hourly
      cron: '0 * * * *'
      database: site1_db
      backup_dir: /var/backups/mysql/site1
      repo_owner: site1user
      # 使用单个站点字段时，只有匹配 pillar.site_name 的主机会安装
      site: site1
    - name: site2-dump-every-2h
      cron: '0 */2 * * *'
      database: site2_db
      backup_dir: /var/backups/mysql/site2
      repo_owner: site2user
      # 可选：通过 sites 列表同时匹配多个站点（如生产 + Staging）
      sites:
        - site2
        - site2-staging
  api_watchers:
    - name: site1-orders
      cron: '*/5 * * * *'
      site: site1
      kinds:
        - orders
        - customers
  stats_jobs:
    - name: site1-stats-daily
      cron: '5 6 * * *'
      site: site1
      period: daily
      # 可选：关闭 Telegram 推送，仅生成日志
      no_telegram: false
    - name: site2-stats-weekly
      cron: '15 6 * * 1'
      sites:
        - site2
        - site2-staging
      period: weekly
      page_size: 500
