{% set dropbox_root = salt['pillar.get']('saltgoat:dropbox_root', '/home/doge/Dropbox') %}
{% set dropbox_root = dropbox_root.rstrip('/') %}
{% set restic_root = dropbox_root + '/backups/restic' %}

secrets:
  # 可选：集中管理默认 Restic 仓库（用于 Salt 状态 optional.backup-restic）
  restic:
    repo: "/var/backups/restic/repos/default"
    password: "ChangeMeRestic!"
    service_user: "root"
    repo_owner: "root"
    paths:
      - /var/www/example
    tags:
      - example
      - magento

  # 推荐：为 CLI 维护的站点定义独立的仓库/密码
  restic_sites:
    bank:
      repo: "{{ restic_root }}/bank"
      password: "ChangeMeBank!"
      service_user: "root"
      repo_owner: "doge"
      paths:
        - /var/www/bank
        - /var/log/nginx/bank
      tags:
        - bank
        - magento
    tank:
      repo: "{{ restic_root }}/tank"
      password: "ChangeMeTank!"
      service_user: "root"
      repo_owner: "doge"
      paths:
        - /var/www/tank
      tags:
        - tank
        - magento
